<!DOCTYPE html>
<html>
  <head>
    <title>EarthX</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        position: absolute;
        top: 350px;
        right: -200;
        width: 500px;
        height: 300px;
      }

    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
  function myfunc(){
    var x= localStorage.getItem("Name");
    var y= localStorage.getItem("Score");
    document.getElementById("sc").innerHTML = "Score: " + y;
    document.getElementById("uname").innerHTML =  x;
    console.log(x);
    console.log(y);
    //window.onload = alert(localStorage.getItem("Name"));
    //window.onload = alert(localStorage.getItem("Score"));
  }
    </script>
    <script>
      // This example requires the Places library. Include the libraries=places
      // parameter when you first load the API. For example:
      // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">

      var map;
      var infowindow;

      function initMap() {
        var myloc = {lat: 32.779322, lng: -96.744047};

        map = new google.maps.Map(document.getElementById('map'), {
          center: myloc,
          zoom: 12
        });

        infowindow = new google.maps.InfoWindow();
        var service = new google.maps.places.PlacesService(map);
        service.nearbySearch({
          //keyword: ['recycling']
          location: myloc,
          radius: 50000,
          //type: ['office'],
          keyword: 'recycle'
        }, callback);
      }
      function callback(results, status) {
        if (status === google.maps.places.PlacesServiceStatus.OK) {
          for (var i = 0; i < results.length; i++) {
            createMarker(results[i]);
          }
        }
      }

      function createMarker(place) {
        var placeLoc = place.geometry.location;
        var marker = new google.maps.Marker({
          map: map,
          icon: "./recycle1.png",
          position: place.geometry.location
        });

        google.maps.event.addListener(marker, 'click', function() {
          infowindow.setContent(place.name);
          infowindow.open(map, this);
        });
      }
    </script>
  </head>
  <body onload="myfunc()">




    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD6kCl-09veS1MYRqvVSTbaTX-fBeW67SM&libraries=places&callback=initMap" async defer></script>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/skel.min.js"></script>
    <script src="assets/js/util.js"></script>
    <!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
    <script src="assets/js/main.js"></script>
    <script>
function add()
{
var score = document.getElementById("p").textContent
score++
document.getElementById("p").innerHTML = score
}

</script>

    <section id="two" class="main style2">

      <div class="container">
        <div class="row 150%">
          <div class="6u 12u$(medium)">
            <p id="sc"><span id="5sc"></span></p>
              <div class="col-md-10">

                <div class="progress">
                  <div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width:70%">
                    <span class="sr-only">70% Complete</span>
                  </div>
                </div>
              </div>



            <form action="/api/recycle" method="POST" id="recyle-form" style="display: block">
              <select id="mysel">
              <div class="form-group">

                <option value="Plastic" style="color: #000;">Plastic</option>
                </div>
                <div class="form-group" style="margin-top: 5px">
                  <option value="card" style="color: #000;" >Cardboard</option>
                </div>
                <div class="form-control">
                  <br>
                  <option value="Alu" style="color: #000;x">Aluminium</option>
                </div>
                </select>
                <div class="form-control" style="margin-top: 2%">
                  <button type="submit" class="major-icons" style="text-align: right">Recycle now</button>
                </div>

            </form>
            <script>

    				let type = $("#mysel");
    				let loginForm= $("#recycle-form");

    				loginForm.submit(function(e){
    					e.preventDefault();
    					console.log("username");
    					console.log(material.val());
    					user = username.val();
    					pass = password.val();


    					let data = {};
    					data["material"] = type.val();

    					console.log(data);
    					$.ajax({
    						type: loginForm.attr('method'),
    						url: loginForm.attr('action'),
    						data: JSON.stringify(data),
                            contentType: 'application/json; charset=utf-8',
                            dataType: 'json',
    						success: function(data) {
    							console.log("Submission was successful.");
    							console.log(data);
    							/* User exists so show him another page
    							if (data.login == "True") {
    								localStorage.setItem("Name",data.fName);
    								localStorage.setItem("Score",data.score);
    								localStorage.setItem("Username", data.username);
    								console.log(data);
    								window.location.href = "/second.html";
    							} else {
    								console.log("False data login");
    								login_false();
    							}*/
    						},
    						error: function(data) {
    							console.log("An error occurred.");
    							console.log(data);
    						}
    					});
    				});


            </script>
          </div>

          <div id="map" style="margin-top: 5%"></div>
          <div class="6u$ 12u$(medium)">

            <header class="major">

              <h2 >Welcome, <span id="uname"></span>
                <br>
              "Every day is a good day"<br />
               - unknown</h2>
            </header>

            <p>As part of making this fun you can win free stuff! When you click "Recycle Now" you will be taken to an adventure full of wonderful journies as you recycle your stuff.</p>
            <p>Need guidance? look to your left! we have have already scoped the area for you on where to take your goods. Put on your shoes, saddle up and prepare to make the world a better place. </p>
            <p>Don't worry about keeping up on your points, we've got you covered. You see the circle up there with your reward points? As soon as it reaches 100 points, we will give you a gift for free! </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Script for updating the user with the new recycle score -->
    <script>
      /*let type = $("#material-type");
				let quantity = $("#recycle-quantity");
        let recycleForm= $("#recyle-form");
        let Username = localStorage.getItem("Username");
        let htmlScore =

				recycleForm.submit(function(e){
					e.preventDefault();
					typeVal = type.val();
					quantityVal = quantity.val();
					let data = {type: typeVal, quantity: quantityVal, username: Username};
					console.log("Data from Front End");
					console.log(data);
					$.ajax({
						type: recycleForm.attr('method'),
						url: recycleForm.attr('action'),
						data: JSON.stringify(data),
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'json',
						success: function(data) {
							console.log("Recycle Submission was successful.");
              console.log(data);
              const newScore = data.score;
              localStorage.setItem("Score", newScore);
              document.getElementById("sc").innerHTML = "Score: " + newScore;
						},
						error: function(data) {
							console.log("An error occurred.");
							console.log(data);
						}
					});
				});*/
    </script>
  </body>
</html>
